<copied from canvas - too large for inline, will be added from below>